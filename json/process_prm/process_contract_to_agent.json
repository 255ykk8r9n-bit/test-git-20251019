{
  "source": "契約ファイル",
  "version": "1.0",

  "named_expressions": [
    {"name": "新契修Ｓ",
      "expr": { 
        "case": {
          "whens": [ 
            { "when": {"column":"新規契約フラグ","op":"=","value":1}, 
              "then": {"col":"修Ｓ"} 
            } 
          ],
          "else": {"val":0}
        }
      }
    } 
  ],

  "group_by": ["氏名コード", "成績年月"],
  "aggregations": [
    {"fn": "SUM", "expr": "修Ｓ",   "alias": "総修Ｓ"},
    {"fn": "SUM", "expr": "収入Ｐ", "alias": "総収入Ｐ"},
    {"fn": "SUM", "expr": {"ref": "新契修Ｓ"}, "alias": "新規契約修Ｓ"}
  ],
  "where": [
    {"column": "成績年月", "op": ">=", "value": "202501"} 
  ],
  "order_by": [
    {"expr": "氏名コード", "asc": true},
    {"expr": "成績年月", "asc": true}
  ],
  "limit": null
}
